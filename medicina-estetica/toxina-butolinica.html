<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Toxina Botul√≠nica</title>

    <link rel="stylesheet" href="../css/tailwind.css">

</head>
<body>
    
    <main>

        <div class="container-general w-full block">

            <!-- slider-after-before -->
            <div class="slider-after-before w-full relative overflow-hidden" id="before-after-slider">

                <!-- before -->
                <div class="absolute h-full w-1/2  top-0 z-10" id="before-image">
                    <img src="../img/bg-services/microblading-ojo-desp.jpg" class="w-full h-full block object-cover object-left" alt="">
                </div>

                <!-- after -->
                <div class="block" id="after-image">
                    <img src="../img/bg-services/microblading-ojo-antes.jpg" class="w-full block saturate-0" alt="">
                </div>
                
                <div class="absolute z-10 top-0 left-1/2 bg-red-500 w-1 h-full  touch-pan-y" id="resizer">
                    
                </div>
                
            </div>

        </div>

        
    <script>
        const slider = document.getElementById('before-after-slider');
        const before = document.getElementById('before-image');
        const beforeImage = before.getElementsByTagName('img')[0];
        const resizer = document.getElementById('resizer');

        let active = false;

        //Sort overflow out for Overlay Image
        document.addEventListener("DOMContentLoaded", function () {
            let width = slider.offsetWidth;
            console.log(width);
            beforeImage.style.width = width + 'px';
        });

        //Adjust width of image on resize 
        window.addEventListener('resize', function () {
            let width = slider.offsetWidth;
            console.log(width);
            beforeImage.style.width = width + 'px';
        })

        resizer.addEventListener('mousedown', function () {
            active = true;
            resizer.classList.add('resize');

        });

        document.body.addEventListener('mouseup', function () {
            active = false;
            resizer.classList.remove('resize');
        });

        document.body.addEventListener('mouseleave', function () {
            active = false;
            resizer.classList.remove('resize');
        });

        document.body.addEventListener('mousemove', function (e) {
            if (!active) return;
            let x = e.pageX;
            x -= slider.getBoundingClientRect().left;
            slideIt(x);
            pauseEvent(e);
        });

        resizer.addEventListener('touchstart', function () {
            active = true;
            resizer.classList.add('resize');
        });

        document.body.addEventListener('touchend', function () {
            active = false;
            resizer.classList.remove('resize');
        });

        document.body.addEventListener('touchcancel', function () {
            active = false;
            resizer.classList.remove('resize');
        });

        //calculation for dragging on touch devices
        document.body.addEventListener('touchmove', function (e) {
            if (!active) return;
            let x;

            let i;
            for (i = 0; i < e.changedTouches.length; i++) {
                x = e.changedTouches[i].pageX;
            }

            x -= slider.getBoundingClientRect().left;
            slideIt(x);
            pauseEvent(e);
        });

        function slideIt(x) {
            let transform = Math.max(0, (Math.min(x, slider.offsetWidth)));
            before.style.width = transform + "px";
            resizer.style.left = transform - 0 + "px";
        }

        //stop divs being selected.
        function pauseEvent(e) {
            if (e.stopPropagation) e.stopPropagation();
            if (e.preventDefault) e.preventDefault();
            e.cancelBubble = true;
            e.returnValue = false;
            return false;
        }
    </script>


    </main>


</body>
</html>